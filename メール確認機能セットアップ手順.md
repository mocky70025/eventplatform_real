# メール確認機能セットアップ手順

## 1. Supabase Dashboardでメール確認を有効化

1. [Supabase Dashboard](https://app.supabase.com/) にログイン
2. プロジェクトを選択
3. 左メニューから **Authentication** をクリック
4. **Providers** タブをクリック
5. **Email** プロバイダーを探す（リストの中にあります）
6. **Email** の右側にある設定アイコン（⚙️）または「Configure」ボタンをクリック
7. **Confirm Email** または **Enable email confirmations** のトグルスイッチを **ON** にする
8. **Save** ボタンをクリックして設定を保存

## 2. リダイレクトURLの設定

1. **Authentication** セクション内で **URL Configuration** または **Settings** を探す
   - 見つからない場合は、**Authentication** のメインページに設定項目がある可能性があります
2. **Site URL** を確認（例: `https://tomorrow-event-platform-store.vercel.app`）
3. **Redirect URLs** または **Allowed Redirect URLs** に以下を追加：
   - `https://tomorrow-event-platform-store.vercel.app/auth/verify-email`
   - `https://tomorrow-event-platform-organizer.vercel.app/auth/verify-email`
   - （開発環境の場合は、`http://localhost:3000/auth/verify-email` なども追加）
4. **Save** ボタンをクリックして設定を保存

**注意**: URL Configurationが見つからない場合：
- **Authentication** > **Providers** > **Email** の設定画面内にリダイレクトURLの設定がある可能性があります
- または、プロジェクト設定（**Settings** > **API**）にリダイレクトURLの設定がある可能性があります

## 3. メールテンプレートの確認（オプション）

1. **Authentication** セクション内で **Email Templates** または **Templates** を探す
2. **Confirm signup** テンプレートを確認
3. 必要に応じて、メールの内容をカスタマイズ

## 4. 動作確認

1. アプリケーションでメールアドレス・パスワードで新規登録
2. 登録したメールアドレスに確認メールが届くことを確認
3. メール内のリンクをクリック
4. メールアドレスが確認され、アプリケーションにリダイレクトされることを確認

## トラブルシューティング

### Settingsが見つからない場合

最新のSupabase Dashboardでは、設定項目の場所が変更されている可能性があります。以下の場所を確認してください：

1. **Authentication** > **Providers** > **Email** の設定画面内
2. プロジェクトの **Settings** > **API** セクション
3. プロジェクトの **Settings** > **Auth** セクション

### メール確認の設定が見つからない場合

1. **Authentication** > **Providers** で **Email** が有効になっているか確認
2. **Email** の設定画面を開き、詳細設定を確認
3. 画面をリロードしてみる

## 注意事項

- メール確認が有効な場合、メールアドレスが確認されるまで一部の機能が制限される可能性があります
- 開発環境では、メールが送信されない場合があります（Supabaseの無料プランの制限）
- 本番環境では、メール送信サービス（SendGrid、Mailgunなど）の設定を推奨
- メール確認を有効にすると、新規登録時に確認メールが送信されます

