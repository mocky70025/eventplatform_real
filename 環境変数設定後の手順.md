# 環境変数設定後の手順

## 1. 再デプロイの実行

環境変数を追加・変更した後は、**必ず再デプロイが必要**です。

### 主催者アプリ（organizer-web）の再デプロイ

1. [Vercel Dashboard](https://vercel.com/dashboard) にアクセス
2. `tomorrow-organizer-web` プロジェクトを選択
3. 「Deployments」タブをクリック
4. 最新のデプロイメントの右側の「...」メニューをクリック
5. 「Redeploy」を選択
6. 「Use existing Build Cache」のチェックを**外す**（重要）
7. 「Redeploy」をクリック
8. デプロイ完了を待つ（約2-3分）

### 出店者アプリ（store-web または store-liff）の再デプロイ

1. [Vercel Dashboard](https://vercel.com/dashboard) にアクセス
2. `tomorrow-store-web` または `tomorrow-store-liff` プロジェクトを選択
3. 「Deployments」タブをクリック
4. 最新のデプロイメントの右側の「...」メニューをクリック
5. 「Redeploy」を選択
6. 「Use existing Build Cache」のチェックを**外す**（重要）
7. 「Redeploy」をクリック
8. デプロイ完了を待つ（約2-3分）

## 2. 動作確認

### 出店者登録時の自動期限確認

1. 出店者アプリにアクセス
2. 新規登録を開始
3. 営業許可証をアップロード
4. **確認**: アップロード完了後、自動で期限確認が実行されること
5. **確認**: 期限内なら「有効」、期限切れなら「期限切れ」が表示されること
6. **確認**: 期限切れの場合は警告が表示されること

### 主催者側の期限確認

1. 主催者アプリにログイン
2. イベントの申し込み管理画面を開く
3. 出店者の詳細を表示
4. 営業許可証の画像が表示されていることを確認
5. 「期限確認」ボタンをクリック
6. **確認**: 確認結果が表示されること（有効/期限切れ、期限日、理由）

## 3. エラーが発生する場合

### エラー: "OpenAI API is not configured"

- 環境変数 `OPENAI_API_KEY` が正しく設定されているか確認
- Vercelの「Settings」→「Environment Variables」で確認
- 再デプロイが完了しているか確認

### エラー: "Invalid API key"

- APIキーが正しくコピーされているか確認
- APIキーに余分なスペースや改行が含まれていないか確認
- OpenAI PlatformでAPIキーが有効か確認

### エラー: "Rate limit exceeded"

- OpenAI APIの使用制限に達している可能性があります
- [OpenAI Platform](https://platform.openai.com/account/billing) で使用状況を確認
- 必要に応じて、使用制限を引き上げるか、プランをアップグレード

## 4. 確認完了後のチェックリスト

- [ ] 主催者アプリの再デプロイが完了
- [ ] 出店者アプリの再デプロイが完了
- [ ] 出店者登録時の自動期限確認が動作
- [ ] 主催者側の期限確認ボタンが動作
- [ ] エラーが発生していない

