# 主催者登録エラー修正手順

## 問題

主催者登録フォームで「Failed to fetch」エラーが発生する。

## 原因

SupabaseのRLS（Row Level Security）ポリシーが厳しすぎて、LINE Loginのみを使用している場合に`organizers`テーブルへのアクセスが拒否されています。

## 解決方法

### ステップ1: Supabase RLSポリシーを修正

1. Supabaseダッシュボードを開く
2. 「SQL Editor」を開く
3. 以下のSQLを実行：

```sql
-- Supabase RLSポリシー修正
-- organizersテーブルに公開アクセスを許可

-- 1. 既存のRLSポリシーを削除
DROP POLICY IF EXISTS "Users can view their own data" ON organizers;
DROP POLICY IF EXISTS "Users can insert their own data" ON organizers;
DROP POLICY IF EXISTS "Users can update their own data" ON organizers;
DROP POLICY IF EXISTS "Allow authenticated users to view organizers" ON organizers;
DROP POLICY IF EXISTS "Allow authenticated users to insert organizers" ON organizers;
DROP POLICY IF EXISTS "Allow authenticated users to update organizers" ON organizers;
DROP POLICY IF EXISTS "Allow public insert on organizers" ON organizers;
DROP POLICY IF EXISTS "Allow public select on organizers" ON organizers;
DROP POLICY IF EXISTS "Allow public update on organizers" ON organizers;

-- 2. 新しいRLSポリシーを作成（公開アクセス許可）
CREATE POLICY "Allow public insert on organizers" ON organizers
    FOR INSERT WITH CHECK (true);

CREATE POLICY "Allow public select on organizers" ON organizers
    FOR SELECT USING (true);

CREATE POLICY "Allow public update on organizers" ON organizers
    FOR UPDATE USING (true);
```

### ステップ2: 動作確認

1. ブラウザのキャッシュをクリア（Ctrl+Shift+R / Cmd+Shift+R）
2. `https://tomorrow-event-platform-organizer.vercel.app` にアクセス
3. 主催者登録フォームを入力
4. 「登録する」ボタンをクリック
5. 正常に登録できるか確認

---

## 注意事項

⚠️ **セキュリティ**: この設定は公開アクセスを許可しています。本番環境では、アプリケーション側で適切な認証チェックを行うことを推奨します。

将来的には、LINE Loginのトークンを使ってSupabaseの認証セッションを作成する方法を検討してください。

---

## トラブルシューティング

### まだエラーが発生する場合

1. **ブラウザのコンソール（F12）でエラーを確認**
   - エラーメッセージの詳細を確認
   - ネットワークタブでリクエストが送信されているか確認

2. **Supabaseの環境変数を確認**
   - Vercelの環境変数で`NEXT_PUBLIC_SUPABASE_URL`と`NEXT_PUBLIC_SUPABASE_ANON_KEY`が正しく設定されているか確認

3. **Supabaseダッシュボードで確認**
   - `organizers`テーブルが存在するか確認
   - RLSが有効になっているか確認
   - ポリシーが正しく作成されているか確認

