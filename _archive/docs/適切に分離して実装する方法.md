# 適切に分離して実装する方法

## 「適切に分離」とは？

**動的な部分（React）と静的な部分（SVG/CSS）を明確に分ける**ことです。

---

## ❌ 悪い例：混在している

### 問題のある実装

```jsx
// ❌ 全てSVGに詰め込もうとしている
function EventForm() {
  const [eventName, setEventName] = useState('');
  
  return (
    <svg width="393" height="800">
      {/* 背景 */}
      <rect width="393" height="800" fill="#E8F5F5"/>
      
      {/* 入力フィールドをSVGで作ろうとしている（無理） */}
      <foreignObject x="20" y="100" width="353" height="50">
        <input 
          type="text" 
          value={eventName}  // ← Reactの状態を使いたい
          onChange={(e) => setEventName(e.target.value)}  // ← でもSVG内では難しい
        />
      </foreignObject>
      
      {/* ボタンもSVGで作ろうとしている */}
      <rect x="20" y="200" width="353" height="52" fill="#FF8A5C">
        {/* クリック処理をどうする？ */}
      </rect>
    </svg>
  );
}
```

**問題点**：
- SVG内でReactの状態管理が複雑
- イベントハンドリングが困難
- 条件付きレンダリングが難しい
- バリデーションやエラー表示ができない

---

## ✅ 良い例：適切に分離

### 1. 静的要素（SVG）と動的要素（React）を分離

```jsx
function EventForm() {
  // React: データ管理
  const [eventName, setEventName] = useState('');
  const [error, setError] = useState('');
  
  return (
    <div style={{ background: '#E8F5F5', minHeight: '100vh' }}>
      {/* SVG: 静的な装飾アイコン（左側） */}
      <div style={{ position: 'absolute', top: 20, left: 20, opacity: 0.1 }}>
        <svg width="100" height="100" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="40" fill="#FF8A5C"/>
        </svg>
      </div>
      
      {/* React + CSS: 動的な入力フィールド */}
      <div style={{ padding: '24px', maxWidth: '393px', margin: '0 auto' }}>
        <input
          type="text"
          value={eventName}  // React: データを表示
          onChange={(e) => {
            setEventName(e.target.value);  // React: データを更新
            setError('');  // React: エラーをクリア
          }}
          style={{  // CSS: 見た目
            width: '100%',
            padding: '12px 16px',
            border: error ? '1px solid red' : '1px solid #E5E5E5',
            borderRadius: '8px',
            fontSize: '16px'
          }}
        />
        
        {/* React: 条件付きエラー表示 */}
        {error && (
          <p style={{ color: 'red', fontSize: '14px', marginTop: '4px' }}>
            {error}
          </p>
        )}
        
        {/* React + CSS: ボタン */}
        <button
          onClick={() => {
            if (!eventName) {
              setError('イベント名を入力してください');
            } else {
              handleSubmit();
            }
          }}
          style={{  // CSS: 見た目
            width: '100%',
            padding: '16px 24px',
            background: '#FF8A5C',
            color: 'white',
            borderRadius: '8px',
            border: 'none',
            fontSize: '16px',
            fontWeight: 'bold',
            cursor: 'pointer'
          }}
        >
          送信
        </button>
      </div>
    </div>
  );
}
```

**良い点**：
- ✅ SVGは装飾のみ（静的な絵）
- ✅ 入力フィールドはReact（データ管理、イベント処理）
- ✅ ボタンはReact（クリック処理、状態管理）
- ✅ エラー表示もReact（条件付きレンダリング）

---

## 2. より具体的な例：ログインボタン

### ❌ 悪い例：SVGに全て詰め込む

```jsx
function LoginButton() {
  const [isLoading, setIsLoading] = useState(false);
  
  return (
    <svg width="200" height="50">
      {/* 背景 */}
      <rect 
        width="200" 
        height="50" 
        fill={isLoading ? "#D9D9D9" : "#FF8A5C"}  // ← SVG内で状態を反映するのは複雑
        rx="8"
        onClick={() => setIsLoading(true)}  // ← SVG内でイベント処理
      />
      {/* テキスト */}
      <text 
        x="100" 
        y="30" 
        fill="white"
        textAnchor="middle"
      >
        {isLoading ? 'ログイン中...' : 'ログイン'}  {/* ← SVG内で条件分岐 */}
      </text>
    </svg>
  );
}
```

### ✅ 良い例：適切に分離

```jsx
function LoginButton() {
  const [isLoading, setIsLoading] = useState(false);
  
  return (
    <button
      onClick={() => {
        setIsLoading(true);
        handleLogin();
      }}
      disabled={isLoading}  // React: 無効化状態
      style={{  // CSS: 見た目
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '8px',
        width: '200px',
        height: '50px',
        background: isLoading ? '#D9D9D9' : '#FF8A5C',  // CSS: 条件付きスタイル
        color: 'white',
        borderRadius: '8px',
        border: 'none',
        fontSize: '16px',
        fontWeight: 'bold',
        cursor: isLoading ? 'not-allowed' : 'pointer'
      }}
    >
      {/* SVG: アイコン（静的な絵） */}
      <svg width="24" height="24" viewBox="0 0 24 24">
        <path d="M..." fill="white"/>
      </svg>
      
      {/* React: テキスト（動的な表示） */}
      <span>{isLoading ? 'ログイン中...' : 'ログイン'}</span>
    </button>
  );
}
```

**分離のポイント**：
- **SVG**: アイコンの絵だけ（静的な要素）
- **React**: 状態管理、イベント処理、条件付き表示（動的な要素）
- **CSS**: 見た目（スタイル）

---

## 3. 複雑な例：イベント登録フォーム

### ❌ 悪い例：全てSVGで実装しようとする

```jsx
function RegistrationForm() {
  const [formData, setFormData] = useState({
    eventName: '',
    date: '',
    location: ''
  });
  
  return (
    <svg width="393" height="1200">
      {/* 背景カード */}
      <rect x="20" y="100" width="353" height="500" fill="white" rx="16"/>
      
      {/* 入力フィールドをSVGで表現しようとする */}
      <foreignObject x="40" y="130" width="313" height="50">
        <input 
          type="text"
          value={formData.eventName}
          onChange={(e) => setFormData({...formData, eventName: e.target.value})}
        />
      </foreignObject>
      
      {/* 日付選択 */}
      <foreignObject x="40" y="200" width="313" height="50">
        <input 
          type="date"
          value={formData.date}
          onChange={(e) => setFormData({...formData, date: e.target.value})}
        />
      </foreignObject>
      
      {/* 送信ボタン */}
      <rect x="40" y="400" width="313" height="52" fill="#FF8A5C" rx="8"/>
      <text x="196.5" y="430" fill="white" textAnchor="middle">送信</text>
    </svg>
  );
}
```

**問題点**：
- `foreignObject`を使っているが、複雑で扱いにくい
- SVGとReactの状態管理が混在
- レスポンシブ対応が困難
- バリデーションやエラー表示が難しい

### ✅ 良い例：適切に分離

```jsx
function RegistrationForm() {
  const [formData, setFormData] = useState({
    eventName: '',
    date: '',
    location: ''
  });
  const [errors, setErrors] = useState({});
  
  return (
    <div style={{ background: '#E8F5F5', minHeight: '100vh' }}>
      {/* SVG: 静的な装飾（背景のパターンなど） */}
      <div style={{ 
        position: 'absolute', 
        top: 0, 
        right: 0, 
        opacity: 0.1,
        pointerEvents: 'none'  // クリックイベントを無効化
      }}>
        <svg width="200" height="200" viewBox="0 0 200 200">
          <circle cx="100" cy="100" r="80" fill="#FF8A5C"/>
        </svg>
      </div>
      
      {/* React + CSS: 動的なフォーム */}
      <div style={{ 
        maxWidth: '393px', 
        margin: '0 auto', 
        padding: '24px',
        position: 'relative',
        zIndex: 1
      }}>
        {/* カード背景（CSS） */}
        <div style={{
          background: 'white',
          borderRadius: '16px',
          padding: '24px',
          boxShadow: '0px 2px 8px rgba(0, 0, 0, 0.08)'
        }}>
          <h2 style={{
            fontSize: '24px',
            fontWeight: 'bold',
            color: '#2C3E50',
            marginBottom: '24px'
          }}>
            イベント情報
          </h2>
          
          {/* React: 入力フィールド */}
          <div style={{ marginBottom: '20px' }}>
            <label style={{
              display: 'block',
              fontSize: '14px',
              color: '#2C3E50',
              marginBottom: '8px',
              fontWeight: 'bold'
            }}>
              イベント名
            </label>
            <input
              type="text"
              value={formData.eventName}  // React: データ表示
              onChange={(e) => {
                setFormData({...formData, eventName: e.target.value});  // React: データ更新
                if (errors.eventName) {
                  setErrors({...errors, eventName: ''});  // React: エラークリア
                }
              }}
              style={{  // CSS: 見た目
                width: '100%',
                padding: '12px 16px',
                border: errors.eventName ? '1px solid red' : '1px solid #E5E5E5',
                borderRadius: '8px',
                fontSize: '16px',
                boxSizing: 'border-box'
              }}
            />
            {/* React: エラー表示 */}
            {errors.eventName && (
              <p style={{ color: 'red', fontSize: '14px', marginTop: '4px' }}>
                {errors.eventName}
              </p>
            )}
          </div>
          
          {/* 他のフィールドも同様... */}
          
          {/* React + CSS: 送信ボタン */}
          <button
            onClick={handleSubmit}  // React: クリック処理
            disabled={isSubmitting}  // React: 無効化状態
            style={{  // CSS: 見た目
              width: '100%',
              padding: '16px 24px',
              background: isSubmitting ? '#D9D9D9' : '#FF8A5C',  // CSS: 条件付きスタイル
              color: 'white',
              borderRadius: '8px',
              border: 'none',
              fontSize: '16px',
              fontWeight: 'bold',
              cursor: isSubmitting ? 'not-allowed' : 'pointer'
            }}
          >
            {isSubmitting ? '送信中...' : '送信'}  {/* React: 条件付き表示 */}
          </button>
        </div>
      </div>
    </div>
  );
}
```

**分離のポイント**：
- **SVG**: 装飾的な背景パターンのみ（静的な要素、`pointerEvents: 'none'`でイベント無効化）
- **React**: フォームデータ、バリデーション、エラー表示、送信処理（動的な要素）
- **CSS**: レイアウト、色、サイズ、余白（見た目）

---

## 適切に分離するために必要なこと

### 1. **Figmaから正確な情報を取得**
   - 位置、サイズ、色、フォントなどの正確な値
   - どの部分が静的で、どの部分が動的かを判断

### 2. **役割を明確に分ける**
   ```
   静的（変化しない）→ SVG
   - アイコン
   - 装飾的な図形
   - ロゴ
   - 背景パターン
   
   動的（変化する）→ React
   - 入力フィールド
   - ボタン（状態、クリック処理）
   - 条件付き表示
   - データ表示
   
   見た目 → CSS
   - 色、サイズ、余白
   - レイアウト
   - アニメーション
   ```

### 3. **実装の順序**
   1. Figmaからデザイン情報を取得
   2. 静的要素（SVG）と動的要素（React）を分類
   3. 静的要素はSVGで実装（装飾のみ）
   4. 動的要素はReact + CSSで実装（機能 + 見た目）
   5. 組み合わせて統合

### 4. **判断基準**

#### SVGを使うべき場合
- ✅ アイコン（戻るボタンの矢印など）
- ✅ 装飾的な図形（星、円など）
- ✅ ロゴ
- ✅ **変化しない静的な絵**

#### React + CSSを使うべき場合
- ✅ 入力フィールド（値が変わる）
- ✅ ボタン（クリック処理、状態管理）
- ✅ 条件付き表示（エラー、ローディングなど）
- ✅ データ表示（計算結果、APIからのデータなど）
- ✅ **動的な機能やデータ**

---

## 実装のチェックリスト

実装時に以下の点を確認：

- [ ] SVGは装飾のみに使っているか？
- [ ] 入力フィールドはReactで実装しているか？
- [ ] ボタンはReactで実装しているか（クリック処理がある）？
- [ ] 状態管理（useState）はReactコンポーネント内で行われているか？
- [ ] 条件付き表示はReactで実装しているか？
- [ ] CSSで見た目を指定しているか？
- [ ] SVGとReactの役割が明確に分離されているか？

---

## まとめ

**適切に分離 = 静的な部分（SVG）と動的な部分（React）を明確に分ける**

- **SVG**: 絵を描く（静的な装飾）
- **React**: 動きやデータを扱う（機能）
- **CSS**: 見た目を決める（スタイル）

この3つを適切に組み合わせることで、**Figmaのデザインを正確に再現しつつ、動的な機能も実装できる**ようになります。


