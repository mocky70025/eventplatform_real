# 現状整理と機能要件

## プロジェクト概要

イベント出店プラットフォーム。出店者（exhibitor）がイベントに申し込み、主催者（organizer）がイベントを管理するシステム。

---

## 現在の構成

### アプリケーション構成

1. **store-web**（出店者アプリ - Web環境）
   - URL: `https://store-web-ten.vercel.app/`
   - 認証: メールアドレス・パスワードのみ
   - 環境: Webブラウザ

2. **store-liff**（出店者アプリ - LIFF環境）
   - URL: `https://store-liff.vercel.app/`
   - LIFF URL: `https://liff.line.me/2008516155-aJjzRG8Z`
   - 認証: LINE Loginのみ
   - 環境: LINEアプリ内ブラウザ

3. **organizer-web**（主催者アプリ - Web環境）
   - URL: `https://organizer-web.vercel.app/`
   - 認証: メールアドレス・パスワードのみ
   - 環境: Webブラウザ

4. **admin**（運営管理ダッシュボード）
   - URL: `https://admin-pearl-sigma.vercel.app/`
   - 認証: （未実装？）
   - 環境: Webブラウザ

---

## 現在の機能（実装済み）

### 出店者（store）の機能

#### 認証・登録
- ✅ LINE Login（LIFF環境のみ）
- ✅ メールアドレス・パスワード（Web環境のみ）
- ✅ 新規登録フォーム（3ステップ）
  - ステップ1: 基本情報（名前、性別、年齢、電話番号、メールアドレス、ジャンル）
  - ステップ2: 必要書類のアップロード（営業許可証、車検証、自賠責保険証、防火設備配置図など）
  - ステップ3: 利用規約の確認
- ✅ 登録情報の表示
- ✅ 登録情報の編集

#### イベント関連
- ✅ イベント一覧の表示
- ✅ イベント詳細の表示
- ✅ イベントへの申し込み
- ✅ 申し込み状況の確認・管理

#### その他
- ✅ 画像アップロード機能
- ✅ フォームの下書き保存機能

---

### 主催者（organizer）の機能

#### 認証・登録
- ✅ メールアドレス・パスワード（Web環境のみ）
- ✅ 新規登録フォーム（会社情報、個人情報）
- ✅ 登録情報の表示
- ✅ 登録情報の編集

#### イベント管理
- ✅ イベントの作成
- ✅ イベント一覧の表示
- ✅ イベントの編集
- ✅ イベント画像のアップロード
- ✅ 申し込み状況の確認
- ✅ 申し込みステータスの変更（承認/却下など）

---

### 運営管理（admin）の機能

- ✅ 主催者一覧の表示
- ✅ 主催者の承認/非承認
- ✅ イベント一覧の表示
- ✅ イベントの承認/非承認（？）

---

## 現在の問題点・課題

### 1. メール送信の問題
- ❌ メール確認メールが届かない
- ✅ 一時的な対応: メール確認を無効化（開発中）
- ⚠️ 本番環境ではメール確認を有効化する必要がある

### 2. 認証方法の制限
- ✅ 環境ごとに認証方法を制限（LIFF=LINEのみ、Web=メールのみ）
- ⚠️ 後でメール認証を追加してもバグらないように実装済み

### 3. 未実装・未確認の機能
- ❓ 検索機能（イベント検索）
- ❓ 運営管理ダッシュボードの認証
- ❓ その他の細かい機能

---

## 欲しい機能（再確認）

### 必須機能（コア機能）

#### 出店者（store）
1. **認証・登録**
   - [x] LINE Login（LIFF環境）
   - [x] メールアドレス・パスワード（Web環境）
   - [x] 新規登録フォーム
   - [x] 登録情報の表示・編集

2. **イベント関連**
   - [x] イベント一覧の表示
   - [x] イベント詳細の表示
   - [x] イベントへの申し込み
   - [x] 申し込み状況の確認・管理
   - [ ] イベント検索機能（？）

#### 主催者（organizer）
1. **認証・登録**
   - [x] メールアドレス・パスワード（Web環境）
   - [x] 新規登録フォーム
   - [x] 登録情報の表示・編集

2. **イベント管理**
   - [x] イベントの作成
   - [x] イベント一覧の表示
   - [x] イベントの編集
   - [x] イベント画像のアップロード
   - [x] 申し込み状況の確認
   - [x] 申し込みステータスの変更

#### 運営管理（admin）
1. **管理機能**
   - [x] 主催者一覧の表示
   - [x] 主催者の承認/非承認
   - [x] イベント一覧の表示
   - [x] イベントの承認/非承認
   - [ ] 認証機能（？）

---

### オプション機能（あれば良い機能）

- [ ] イベント検索・フィルタリング機能
- [ ] 通知機能
- [ ] メッセージ機能
- [ ] レビュー・評価機能
- [ ] 決済機能
- [ ] その他

---

## 技術スタック

- **フロントエンド**: Next.js 14, React, TypeScript
- **バックエンド**: Next.js API Routes
- **データベース**: Supabase (PostgreSQL)
- **認証**: Supabase Auth + LINE Login
- **ストレージ**: Supabase Storage
- **デプロイ**: Vercel

---

## データベース構造

### 主要テーブル
- `exhibitors`: 出店者情報
- `organizers`: 主催者情報
- `events`: イベント情報
- `event_applications`: イベント申し込み情報
- `form_drafts`: フォーム下書き

### 認証
- `auth.users`: Supabase Authのユーザー情報
- `line_user_id`: LINE Login用のユーザーID
- `user_id`: Supabase Auth用のユーザーID

---

## 次のステップ（整理）

### 優先度: 高

1. **メール送信の問題を解決**
   - 開発中はメール確認を無効化（完了）
   - 本番環境ではメール確認を有効化する方法を検討

2. **動作確認の完了**
   - store-web: メール認証での新規登録・ログイン
   - store-liff: LINE認証での新規登録・ログイン
   - organizer-web: メール認証での新規登録・ログイン
   - admin: 運営管理ダッシュボードの動作確認

3. **未実装機能の確認**
   - イベント検索機能は必要か？
   - 運営管理ダッシュボードの認証は必要か？

### 優先度: 中

1. **エラーハンドリングの改善**
2. **UI/UXの改善**
3. **パフォーマンスの最適化**

### 優先度: 低

1. **追加機能の実装**
2. **テストの追加**

---

## 質問

以下の点を明確にしてください：

1. **イベント検索機能は必要ですか？**
   - イベント名、ジャンル、開催日などで検索できる機能

2. **運営管理ダッシュボードの認証は必要ですか？**
   - 現在は認証なしでアクセスできる状態
   - 管理者のみがアクセスできるようにするか？

3. **メール確認機能は本番環境で必要ですか？**
   - 開発中は無効化しているが、本番環境では有効化するか？

4. **その他、追加したい機能はありますか？**

---

## まとめ

現在の実装状況：
- ✅ 基本的な機能は実装済み
- ✅ 認証方法の簡素化が完了
- ✅ 4つのプロジェクトがVercelにデプロイ済み
- ⚠️ メール送信の問題（開発中は無効化で対応）
- ❓ 一部の機能が未確認・未実装

次のステップ：
1. 動作確認を完了させる
2. 未実装機能の必要性を確認
3. 本番環境に向けた準備

